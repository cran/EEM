<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction to EEM package</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Introduction to EEM package}
-->

<h1>Introduction to EEM package</h1>

<p>edited on 2016.01.22</p>

<h2>Table of contents</h2>

<ul>
<li><a href="#intro">Introduction</a></li>
<li><a href="#import">Importing raw data files</a></li>
<li><a href="#visualize">Visualizing EEM data</a>

<ul>
<li><a href="#drawEEM"><code>drawEEM</code></a></li>
<li><a href="#drawEEMgg"><code>drawEEMgg</code></a></li>
</ul></li>
<li><a href="#preprocess">Preprocessing EEM data</a>

<ul>
<li><a href="#delScattering">Delete Rayleign scattering rays</a> 

<ul>
<li><a href="#delScattering1"><code>delScattering</code></a></li>
<li><a href="#delScattering2"><code>delScattering2</code></a></li>
</ul></li>
<li><a href="#cutEEM">Cutting portion of EEM</a></li>
<li><a href="#unfold">Unfolding 3-d data into 2-d data for multivariate analysis</a></li>
<li><a href="#normalize">Normalize</a></li>
</ul></li>
<li><a href="#export">Exporting data matrix to other stats softwares</a></li>
<li><a href="#analyze">Analyzing EEM data in R</a>

<ul>
<li><a href="#pca">Principle Component Analysis (PCA)</a></li>
<li><a href="#pls">Partial least-squares (PLS) regression</a></li>
</ul></li>
<li><a href="#ref">References</a></li>
</ul>

<h2><a name="intro"></a>Introduction</h2>

<p>Fluorescence fingerprint or more commonly known as complete fluorescence excitation-emission matrix (EEM) is a 3-dimensional data consisting of excitation, emission and intensity axis. The multi-dimension set EEM data apart from other signal processing. Thus, <code>EEM</code> package was developed to facilitate data analysis in R. Basic tools for importing raw data files, deleting Rayleigh scattering rays, unfolding 3-dimensional to 2-dimentional matrix (and vice versa) for further multivariate analysis, and visualizing data are provided in this package. The author has intended this package to be used as a bridge between raw data files and other analysis tools. </p>

<h2><a name="import"></a>Importing raw data files</h2>

<p><code>readEEM</code> function can read raw data files into R. Currently the supported raw data files are limited to certain fluorescence spectrometers (see <code>?readEEM</code> or <a href="https://github.com/chengvt/EEM/blob/master/vignettes/file-io.md">impoting raw files vignette</a> for more details). Basically <code>readEEM</code> will look for a certain keyword in raw files and start to read in the lines below them. Please send a word or pull request to add support for other formats. </p>

<p>Raw data files can be imported using any of the commands below. It can accept both file and folder path. Multiple paths can be specified using a vector. </p>

<pre><code class="r">library(EEM) # load library

# read raw data files from a file
data &lt;- readEEM(file) 
data &lt;- readEEM(&quot;sample1.txt&quot;) # read in a file
data &lt;-readEEM(c(&quot;sample1.txt&quot;, &quot;sample2.txt&quot;)) # read in two files

# read raw data files from a folder
data &lt;- readEEM(folder) 
data &lt;-readEEM(&quot;C:\\data&quot;) # full path. Note that the slash is doubled.
data &lt;- readEEM(&quot;C:/data&quot;) # read in all files in data folder. Aside from double slashes,
                           # a reverted slash can also be used. 

# read raw data files from the current working folder
setwd(choose.dir()) # set working folder interactively (only work in windows)
data &lt;- readEEM(getwd()) # read raw data files in current working folder
</code></pre>

<p>The data is imported as a <code>list</code> and was given a class name of <code>EEM</code>. The original file names are can be retrieved using <code>names(EEM)</code>, and additional information can be obtained using <code>summary(data)</code>. </p>

<p>For demonstation purpose, a dataset called &ldquo;applejuice&rdquo; is attached with the package. It can be called by <code>data(applejuice)</code>. More information about the dataset can be accessed by <code>?applejuice</code>. </p>

<pre><code class="r"># load dataset
data(applejuice) 
class(applejuice) # EEM class
</code></pre>

<pre><code>## [1] &quot;EEM&quot;
</code></pre>

<pre><code class="r"># get sample names
names(applejuice)
</code></pre>

<pre><code>##  [1] &quot;Aomori-Fuji-1-1&quot;  &quot;Aomori-Fuji-1-2&quot;  &quot;Aomori-Fuji-2-1&quot; 
##  [4] &quot;Aomori-Fuji-2-2&quot;  &quot;Aomori-Jona-1-1&quot;  &quot;Aomori-Jona-1-2&quot; 
##  [7] &quot;Aomori-Jona-2-1&quot;  &quot;Aomori-Jona-2-2&quot;  &quot;Aomori-Ohrin-1-1&quot;
## [10] &quot;Aomori-Ohrin-1-2&quot; &quot;Aomori-Ohrin-2-1&quot; &quot;Aomori-Ohrin-2-2&quot;
## [13] &quot;NZ-Envy-1-1&quot;      &quot;NZ-Envy-1-2&quot;      &quot;NZ-Envy-2-1&quot;     
## [16] &quot;NZ-Envy-2-2&quot;      &quot;NZ-Fuji-1-1&quot;      &quot;NZ-Fuji-1-2&quot;     
## [19] &quot;NZ-Fuji-2-1&quot;      &quot;NZ-Fuji-2-2&quot;      &quot;NZ-Jazz-1-1&quot;     
## [22] &quot;NZ-Jazz-1-2&quot;      &quot;NZ-Jazz-2-1&quot;      &quot;NZ-Jazz-2-2&quot;
</code></pre>

<pre><code class="r"># use summary to see information about the dataset.
summary(applejuice)
</code></pre>

<pre><code>## Number of samples: 24
## Sample names: 
##  [1] &quot;Aomori-Fuji-1-1&quot;  &quot;Aomori-Fuji-1-2&quot;  &quot;Aomori-Fuji-2-1&quot; 
##  [4] &quot;Aomori-Fuji-2-2&quot;  &quot;Aomori-Jona-1-1&quot;  &quot;Aomori-Jona-1-2&quot; 
##  [7] &quot;Aomori-Jona-2-1&quot;  &quot;Aomori-Jona-2-2&quot;  &quot;Aomori-Ohrin-1-1&quot;
## [10] &quot;Aomori-Ohrin-1-2&quot; &quot;Aomori-Ohrin-2-1&quot; &quot;Aomori-Ohrin-2-2&quot;
## [13] &quot;NZ-Envy-1-1&quot;      &quot;NZ-Envy-1-2&quot;      &quot;NZ-Envy-2-1&quot;     
## [16] &quot;NZ-Envy-2-2&quot;      &quot;NZ-Fuji-1-1&quot;      &quot;NZ-Fuji-1-2&quot;     
## [19] &quot;NZ-Fuji-2-1&quot;      &quot;NZ-Fuji-2-2&quot;      &quot;NZ-Jazz-1-1&quot;     
## [22] &quot;NZ-Jazz-1-2&quot;      &quot;NZ-Jazz-2-1&quot;      &quot;NZ-Jazz-2-2&quot;     
## Dimension [EmxEx]: 48x26
## EX range: 200~450 [nm]
## EM range: 230~700 [nm]
</code></pre>

<h2><a name="visualize"></a>Visualizing EEM data</h2>

<p>EEM data is usually visualized using a contour representation. Two functions are available for creating contours. </p>

<h3><a name="drawEEM"></a>drawEEM</h3>

<p><code>drawEEM</code> is built based on <code>filled.contour</code> of <code>graphics</code> package and can be used to draw any sample of an <code>EEM</code> class object. </p>

<pre><code class="r"># draw EEM of sample no.1
drawEEM(applejuice, n = 1) 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk drawEEM"/></p>

<pre><code class="r"># draw EEM of sample no.1 with different color
drawEEM(applejuice, n = 1, color.palette = cm.colors) 
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAEgCAMAAAA6+nJRAAABa1BMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrY6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmZjpmZmZmkJBmtrZmtttmtv+A//+D//+H//+K//+O//+QOgCQOjqQOmaQZgCQkGaQtpCQ27aQ29uQ2/+S//+V//+Z//+d//+g//+k//+o//+r//+v//+z//+2ZgC2Zjq225C2/7a2/9u2//+6//+9///B///F///I///M///Q///T///X///bkDrb25Db/7bb/9vb///e///i///l///p///t///w///0///4///7////gP//g///h///iv//jv//kv//lf//mf//nf//oP//pP//qP//q///r///s///tmb/tv//uv//vf//wf//xf//yP//zP//0P//0///1///25D/2///3v//4v//5v//6f//7f//8P//9P//+P//+////7b//9v///9mdaG/AAAACXBIWXMAAAsSAAALEgHS3X78AAAVYklEQVR4nO2diX8UuZWAG0JMSFg7zB7JboeAndMMxxh6h20f2KaT+AJMJpzD4TZgDD4GG2N3//mrs0pVJalKalWrSrzvN/PDNv2qTH39JJX6SdXoA8HR8P0LAO4BqQECUgMEpAYISA0QkBogIDVAQGqAgNQAAakBAlIDBKQGCEgNEJAaICA1QEBqgIDUAAGpAQJSAwSkBghIDRCQGiAgNUBAaoCA1ACpsNTeeGOk4EtPxk63eQyhmfir6K8Ru2eFgya+CYcKS90924hdFCQrNUWrIbxTEt8ERIWldhq/oXI6yNJov99t/Hwcae5QZeyHvfFT/9U49Zc4U8UvTsbOLCUyFTn/ZeQx8U1QVFcq0vI9aR1bJPdGkFQOUsR/SFLzzN+LSp2Y7MZSxW+CorpSUX9HzOyePTWJ9JxCBk63UZPcxF9HP6Qdb7pPHVFI7eN8FzyC1CHTQa0s/p9eePQV/gLrQS3uZPRD/A2Vinw3zvxDKZX89RLzmPgmPCorNcq5lNQzS3qpquYXpFYAfN1J9yk0v7FUofnlUkmU0KeSRIfmt1J08NgWjYeawkAplioMlORS2QtAapUgmYbVjgi3NIJU4ZZGLvVkrNH4bxgohYko9Gsh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" alt="plot of chunk drawEEM"/></p>

<p>The axis can also be flipped by setting <code>flipaxis</code> to TRUE.</p>

<pre><code class="r"># flip the axis
drawEEM(applejuice, n = 1, flipaxis = TRUE) 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk drawEEM2"/></p>

<h3><a name="drawEEMgg"></a>drawEEMgg</h3>

<p><code>drawEEMgg</code> is an alternative contour creator. It uses <code>ggplot2</code> package to draw contour.  </p>

<pre><code class="r"># draw EEM of sample no.1
drawEEMgg(applejuice, n = 1) 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk drawEEMgg"/></p>

<pre><code class="r"># all functionalities in ggplot can be applied directly 
library(ggplot2)
</code></pre>

<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.2.4
</code></pre>

<pre><code class="r"># add grid line to the plot
drawEEMgg(applejuice, n = 1) + theme(panel.grid = element_line(color = &quot;grey&quot;), 
                                     panel.grid.major = element_line(colour = &quot;grey&quot;))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk drawEEMgg"/></p>

<h2><a name="preprocess"></a>Preprocessing EEM data</h2>

<p>Raw EEM data typically requires data cleaning, although some recent machines produced thoroughly cleaned data. Many papers (Fujita et al. (2010), Murphy et al. (2013)) have already discussed about the methods for cleaning and processing EEM data. </p>

<h3><a name="delScattering"></a>Delete Rayleign scattering rays</h3>

<h4><a name="delScattering1"></a><code>delScattering</code></h4>

<p>The Rayleign scattering rays of different orders can be deleted using <code>delScattering</code>. It is possible to choose whether to fill in the blank with NA or 0 by specifying <code>rep</code> (replace) argument. By running this function, the regions unrelated to fluorescence (where Em &lt; Ex) will be also be deleted. </p>

<pre><code class="r"># delete scattering regions and assign them as NA
applejuice_delS &lt;- delScattering(applejuice, rep = NA) 
drawEEM(applejuice_delS, 1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk delScattering1_1"/></p>

<p>The width of each region to be deleted can also be set manually. The default values can be viewed through <code>?delScattering</code>. </p>

<pre><code class="r">applejuice_delS &lt;- delScattering(applejuice, rep = NA, first = 30, second = 0, third = 0, forth = 0) 
drawEEM(applejuice_delS, 1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk delScattering1_2"/></p>

<p><code>rep</code> was set to NA for demonstration purpose. However, since missing values cannot be included in some multivariate analysis, <code>rep</code> should be set to 0.</p>

<pre><code class="r">applejuice_delS &lt;- delScattering(applejuice, rep = 0, 
                                 first = 30, second = 0, third = 0, forth = 0) 
</code></pre>

<h4><a name="delScattering2"></a><code>delScattering2</code></h4>

<p><code>delScattering2</code> is different from <code>delScattering</code> in the way that the region beyond 
the second-order scattering ray is removed, in addition to the regions where emission wavelength is shorten than excitation light (Em &lt;= Ex) and the first- and second-order scattering rays.</p>

<pre><code class="r">drawEEM(delScattering2(applejuice, NA), 1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk delScattering2"/></p>

<h3><a name="cutEEM"></a>Cutting portion of EEM</h3>

<p><code>cutEEM</code> function offers a method to cut portions of EEM by specifying <code>cutEX</code> and <code>cutEM</code> argument values. However, please take note that it is not possible to cut portion in the middle. </p>

<pre><code class="r">applejuice_delS_cut &lt;- cutEEM(applejuice_delS, cutEX = 350:500, cutEM = 500:700)
drawEEM(applejuice_delS_cut, 1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk cutEEM"/></p>

<h3><a name="unfold"></a>Unfolding 3-d data into 2-d data for multivariate analysis</h3>

<p>EEM data can be unfolded into a matrix with columns as variables (wavelength conditions) and rows as samples, which is a common format for multivariate analysis. </p>

<pre><code class="r">## unfold EEM into EEM_uf (matrix form with samples x variables dimension)
applejuice_delS_uf &lt;- unfold(applejuice_delS) 

# dimension of unfolded data
dim(applejuice_delS_uf)
</code></pre>

<pre><code>## [1]   24 1248
</code></pre>

<pre><code class="r"># take a look at unfolded data
applejuice_delS_uf[1:5 ,1:5]
</code></pre>

<pre><code>##                 EX200EM230 EX200EM240 EX200EM250 EX200EM260 EX200EM270
## Aomori-Fuji-1-1   1.584740   2.750280    2.71587    6.51603    21.1658
## Aomori-Fuji-1-2   0.480644   2.064270    4.72847    5.65419    27.9555
## Aomori-Fuji-2-1   2.430540   1.427630    3.28927    5.36893    23.0553
## Aomori-Fuji-2-2   0.461552   2.157030    3.26636    5.78505    28.7779
## Aomori-Jona-1-1  -0.170955   0.362999    2.46317    6.07851    22.4464
</code></pre>

<p>Unfolded data can also be folded back into EEM class by <code>fold</code> function.</p>

<h3><a name="normalize"></a>Normalize</h3>

<p>Unfolded data can be normalized using <code>normalize</code> function to adjust the scaling difference, which is a common bias in spectroscopic applications. This difference can be caused by the scattering effect, source/detector variation and instrumental sensitivity. <code>Normalize</code> function will do the row processing of the unfolded data by divide each variable by the sum of the absolute value of all variables for the given sample. The output will return a matrix where each row is a vector with unit area (area = 1). </p>

<pre><code class="r"># normalize data
applejuice_delS_uf_norm &lt;- normalize(applejuice_delS_uf) 

# the absolute sum of each row should equal to 1
rowSums(abs(applejuice_delS_uf_norm)) 
</code></pre>

<pre><code>##  Aomori-Fuji-1-1  Aomori-Fuji-1-2  Aomori-Fuji-2-1  Aomori-Fuji-2-2 
##                1                1                1                1 
##  Aomori-Jona-1-1  Aomori-Jona-1-2  Aomori-Jona-2-1  Aomori-Jona-2-2 
##                1                1                1                1 
## Aomori-Ohrin-1-1 Aomori-Ohrin-1-2 Aomori-Ohrin-2-1 Aomori-Ohrin-2-2 
##                1                1                1                1 
##      NZ-Envy-1-1      NZ-Envy-1-2      NZ-Envy-2-1      NZ-Envy-2-2 
##                1                1                1                1 
##      NZ-Fuji-1-1      NZ-Fuji-1-2      NZ-Fuji-2-1      NZ-Fuji-2-2 
##                1                1                1                1 
##      NZ-Jazz-1-1      NZ-Jazz-1-2      NZ-Jazz-2-1      NZ-Jazz-2-2 
##                1                1                1                1
</code></pre>

<h2><a name="export"></a>Exporting data matrix to other stats softwares</h2>

<p>After preprocessing and unfolding, the data matrix can be exported as text files to be analyzed by other stats softwares. Note that <a href="#analyze">further analysis is also possible in R</a>. </p>

<pre><code class="r"># export as csv file
write.csv(applejuice_delS_uf, &quot;applejuice.csv&quot;) 
</code></pre>

<p>After analysis with other softwares, the returned values such as regression coefficient or VIP value can be imported back in R so that contours can be easily plotted. The detailed walk through can be found in <a href="https://github.com/chengvt/EEM/blob/master/vignettes/file-io.md#datamatrix_import">impoting raw files vignette</a> for more details)</p>

<h2><a name="analyze"></a>Analyzing EEM data in R</h2>

<h3><a name="pca"></a>Principal component analysis (PCA)</h3>

<p><code>prcomp</code> of <code>stats</code> package can be used to perform PCA on the unfolded data. </p>

<pre><code class="r"># perform PCA
result &lt;- prcomp(applejuice_delS_uf_norm) # mean-centering is enabled by default

# plot scree plot
screeplot(result, npcs = 10, type = &quot;lines&quot;, main = &quot;Screeplot&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk pca"/></p>

<p>The score and loading can be plotted by <code>plotScore</code> and <code>plotLoading</code>, respectively.</p>

<pre><code class="r"># plot score plot 
plotScore(result, xPC = 1, yPC = 2) # pc 1 vs pc 2
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk scoreloading"/></p>

<pre><code class="r"># plot loading plot
plotLoading(result, ncomp = 1) # loading 1
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk scoreloading"/></p>

<p>For our example, PCA will be used to test whether EEM can discriminate apples of different production area and cultivars. Since those information is hidden in the sample names, they will be retrieved first. </p>

<pre><code class="r"># extract sample name
sName &lt;- names(applejuice) 

# country of apple production
country &lt;- sapply(strsplit(sName, split = &quot;-&quot;), &quot;[&quot;, 1) 
table(country) # counts of samples grouped by country
</code></pre>

<pre><code>## country
## Aomori     NZ 
##     12     12
</code></pre>

<pre><code class="r"># cultivar of apples
cultivar &lt;- sapply(strsplit(sName, split = &quot;-&quot;), &quot;[&quot;, 2) 
table(cultivar) # counts of samples grouped by cultivar
</code></pre>

<pre><code>## cultivar
##  Envy  Fuji  Jazz  Jona Ohrin 
##     4     8     4     4     4
</code></pre>

<p>To plot score plot with points colored by group, <code>plotScore</code> and <code>plotScorem</code> can be used.</p>

<pre><code class="r"># plot score plot with grouping
plotScore(result, xPC = 1, yPC = 2,country, legendlocation = &quot;topright&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk scoreg"/></p>

<pre><code class="r"># plot score using scatterplot matrix with grouping
plotScorem(result, ncomp = 5, country)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAdQAAAEgCAMAAAA6+nJRAAAA2FBMVEUAAAAAADoAAGYAKEkAOjoAOpAAZrYoDVE3frg6AAA6ADo6AGY6KmY6OmY6OpA6ZrY6kNtJFwBJSQBjY2NmAABmADpmAGZmFyhmOgBmOpBmZjpmZmZmZrZmkJBmtv97fDqB//+QOgCQOjqQOmaQZjqQZmaQZpCQkDqQkGaQtpCQ27aQ29uQ2/+2ZgC2Zjq2Zma2kDq2tma225C2/7a2/9u2//+8/7a8///bkDrbtmbb25Db27bb2//b/7bb/9vb///kGhz/tmb/25D/29v//4H//7b//9v///+ByLWcAAAACXBIWXMAAAsSAAALEgHS3X78AAAVFUlEQVR4nO2dCXvjthGGuW7s0k3TuJWTNsnWrTdJT2s3aeJW2TY15dTi//9HJe5rcJEgRUHzPT4kARyAeIWDIDBselR1ao6dAVR5IdQKhVArFEKtUAi1QiHUCoVQKxRCrVAItUIh1AqFUCsUQq1QCLVCIdQKhVArFEKtUAi1QiHUCoVQKxRCrVAItUIh1AqFUCsUQq1QCLVCZUF9uW3u+N+X1/wdFCp+y2YVlaosqLu7l8+e6N/311f8HRT6Df998lpCzaksqO8e5c9QU9lLKPQL/vvotYSaU8lQD/fN5dcI9SQ0svl9GqBi87tWZQ+U9nehgdL+DgdKxxde0iyvpoSCCSx1JiipEmWOUFcmhFqhEGqFQqgVap1Qm+Db6PtzF0KtUAi1QiHUCrUmqEUmQhDwyqBOzUgxIycuhFqhEGqFQqgVCqFWqLVALTZwRahGGXTddBuZgaOjzmzkxCXLoKNSAS+fPEQOff7w0bIRTCAjL1OEUANQ91/cZNvIDhwddWYjJy5RBl1nUj28+RtZq/dy21w8Dm/+0jQ3++FXfPL80e8u/oE1daXyQX3+1dP2ru+3N/3+8ulwf9U/X1/RBpd98nx9h83vauVrfncDu6v+5dNH0rke3jz05Hd4yT8hQBHqWuWBergfrjAuHgm3gaYGlX8yF9Tn66Z59UCT54t6ybeIaviabUme+l3TXKmwIerwbjf8srXdCNV7STO0vkPbe7dcTeXXqSTd/eV/72/E6Pvl9oKl8vwxzQKNcri/k2H7q+FjRn5/k55e1fKUwY6U2tD+8j5VQRV96lw1dYD6/Kv35Cv17/8MHx2+/I7X1LcPPMGdGJWzMAp1e8M+eESoRHAZ0OKhFZOPfhVUPvqdEer+8ocr9SFvfsm//QfXQ1O7/f213fzSdqVnX0WEup5pQh6V9al7Fyrl9hPZHrW9fOq3d3rY8HbbDJ/SSoxQ1weV1jlR84h0qD3hRoDyJliGvWcXYAiV6ZhQt2RwdGVEZewOZKB0a4CjzS8Z5t6Rv0ZNJYNxflWNzS/VEaHSSxDWe8uovEIOHXfDx0MvaqBEvgXDpzvyl37MB72EMml+caDEtRao0VtvwyVNTHhJw7Wy5jegXewGA04+CK1soDRdCPW4ze9tQ+cii+YFofbHran6IKlUXhBqj81vldLLoC1gIycwb6BUIjNnIq0M2nYk1YLXqdOFUPUyaHWoZGUDXVq2pxeQ4auJRa5TU4VQbaiS6vM1GZXy+zDPvwgvLMTmd2WSZdCaUD/89kpAJTOxaTayA7H5nUWiDNrWoDrg3IqlZbvLiAtAHP2uTH6oQ5dHoe4vHn0HWzZyA53mFzcdlxEvg7Y1qRKcuxvy9+U26tax1OgXVUieMmeLBv9K1vlewTHiNmKBCHUuBaDSIfA+1qH6bUQD7eYXVUghqP3u4vv7Jl7yEwZKO3TZO4OOPPeLUOcQQq1Qa7pLgyokhFqhEGqFWhNUcIKITIjYn22SZpSmT04Z5k5Iq4IKfUhnuawbvZskI+c7lbx2qOaUdJYRhDqbjQJ3abKoIlSEmm7uhHQCUN0GGPvUsE4AqiuEGtZaoGZdPiDUsNYCNSsqQg0LoYZ1mlDnnnU53sKz84U6uxBqhVoKKrnoaXuEuoiW6lPJDDG5nNWh2k7xyAu+Moc5xbvjL2WY7RQPoYJaCKpc4WpAtZzi7Qg1CvL5Y+FPcyBPobIw2ykeQgW10HWqXLdsQ9Wd4hGxevmWOT4kHtPefC53lexubKd4CBXUrDVVTh62XqimUzzupYf93TXUoZb0EDJ8ajvFQ6ig5oSqpoQVVDVJ3EBO8ZhvUsFteze8ElDFUwN0p3gIFdSMo1/w7o1dUw2neGJTpnKKtyPN/o0ZpjnFQ6igZobqUHWhKqd40u+pcIpH3eGxmirCTKd4CBWUv1SGi4addMAdjgpKa241tC5U5RRvK6ulcopHoQ6QRZjpFA+hggpB/fF137/TNx1zh+9d5LlH9ujX7EnjKac7xUOooBKhknqyIRpw0v/9yP+JM0qJTvEQKqhAqTxfv+LXhDwqezaD/dgjV1ZN5a0wq644TbiAAqXi7CSfAlV0rwh1AQUHSpYjDw1q0KYPKk7oL6QcqHyEBDCNg0aoCyqn+fXG7MJNMgkSVRWhLqAFoNIwhLqgsppfn8TjBRnWbtO5oa4RhDqbEqFGbr3pVLsBaucEuukh1NlUpPk1HgWKUI+uSKlk+Cb0QjWGywh1AeXcpYloYMf+b7qU9aq5C10j5lBKGc0v6lSUMfpFnYoQaoXC5rdChUca6PHsJIVQKxRCrVB4oVehCk4+SIEez/gCfXjyQfpN2wBHJE0+JGcuydqJa6ldb2L9AzhNqFYIb5wDEvOEk46apkNtk55CB+2lscI8R8BJ8n8IFVLiefgbJ7rxNG4A2ktjh0EHeJLkMRAqqKk1lZd9eIVS24eWs0h8iY7TOOsWofpUDKp219TeyuhdoW+uOCV2NuKIQD40qC1ChTQRqmxVdar2VkYf1E5JmNo4B3iStJtnhKqpyOjXgONA9RS+H2rCqNcxh1A1lbmkAaEKNkaVgqHKWJu2R6iTlQXVuwzUYGpAteHYfaq2fom8JAsRky5QbXMIVVPGJU1w1xsBYn7eRna9gYeJ96TSZm2iQ6iacmpqYMW2FuDGgheembXbfZ+WJ9fuBCFUn5xYniWinUURoRbTiD41UvKp6347iOomj6kF1XahJr2mCRdq/AHC1EGT7TytP1OoVNH6lLrtwoJKX4a8ygbyJKBaLtSE1zTqb+Dw5oHHfbm9II5CLOdpPUINRbTI+KBaYYWgWi7UONS3D8r3y+HL7z7lUHXnaf25QDUcaoyFGlyhb/WpJWqq7kJtx5pf6sPng2uxjE40v4bztP4coBJPOLIX0qNGRzMjPXMXgOq4UOPulii9n54EPV59TedpUJZOVKHzGLCK8im2LiAAdZI5WVMNF2o9B6ZcqNF/oqM1nKeVytIKVGaacIyR2aAqF2rSa5pwoWbUVMt5WqksrUCB88jZyjgivdmgKhdq0muacqFGefJBr+k8rVSWVqBAn5q+k9zShKddTOtT/Qq6UDujS5qqoIZcqJ3V5MPo5neNUPOsnbgQKmTtxHUuzW+etRNXItTTuE4tZu3EVdUlTTFrJ67IeYxqfiFBa5SSD/ILoUKaY0bJ8wQpy0hCnxpfqIRQIS00+m3HQE1YfoZQIS00+pV8EOoCWgZqOwZqykpRhAopp/lNlbvpmPExr4uih7baUV5lZy7J2okrfB7o8+EkhVArFEKtULV0IyhNCLVCIdQKhVArFEKtUDkT+olKdbfedW480FlaynRB+hEdTRdOKN9aSt4WV/m7NO6DEWAj4O6N+Vc+8F0jYEK1TDrOATW0LSMCNVejoRayFhJCHSmEOjHlQFR7nz9/ZTmmM400agtz59yLSXTOMgaDzGqrsm3f7EWozgP8lB8lPVILPmqTMZUxbY9ns91P3fTSoxfPWkXuK2eEat4N5XdHIajafdONfmSCK8vxUFsTalWeDhNTDg/RS0DV/f2yt7PeJN8o53vKi+mZQY1ENQcfioxiIgrOWfkgmGpQW12JeRoHtdUraj3uK8uPfl2Hk+INCFUFykP1ihqhOqFP1VsSO61zgpp3DQLWVMifKA+V1mm0pIpqQE0dMYvTcKCeZfPLG9lUtAYV8Qasqa1sC1VryD9PzX6T4gJau4gys3f2UEdNGsjyg5tfos4abmUuEU2IrL6UnjM4c6hBquPW/VKzGxtq8kApHrfToabM/ToO1NTeZfJf+nghwYADtdVDJVc03ItomrdQ+3/L3YKq9MBoG8uraBvxJtoY1tpIJjpuvXNcnoI+SW0HagQzg0q8DVC/aYP2l0+HNw+AA7XVQ2VRjT6Jq3UfYTJyMTerqdBBjjkRnl9TxSuVR2jQq6AaDtQObz6XfkGY37SeVdrdDeBA7USgcplM3dL0QLXnfp1YVqvoHf4qL+7KSMpY2b2W7s2OG6ypmgO13Q1rflmN5M0vqan3N4ADtdOCqgu68hjnxg481JekSDl3aCOTM6A6+yz1PlU5UBugMaiMnupTX7EKbDlQO1moKTMERnNtQR0zlGbpjZoucJMzzAA1VXegtiMjC+VATUDtpa8804HaKqHumovHhA1SUaoBqPGRdCS9zJrqpheyZjtQ6wUvs/m9Yg5KHQdqa4Q6DM1fPvl7gZ3khaEamgw1ZM1xoCYrIXGgRqGSX+4p2nGgtlKow7fvo+lbGWNQA4dGNaJPZQlOW6OU5EBtjVDplbTwfJy1Oi5joGTXm9kXnokEJy48S3GgtkqoVTvHOtPVhHU7x0KosaiWEGo5I6VTPmPnWAh1ZHprxlAt1PHNryNtaiIENfVRjJomYrBSPDOoKZc07rwqlz7hZEA1L2jI1M6yfao9FVY/1Kzm11i2kArVmt9ZFmrHlzHqX6szgEqU2Px2IaieiXf5UFw92vJQ9ap6JlATo8ahBp50rEfbZHarU6C6N5jOAGqGxzPBlL2zNvSysnN24srD9FgLbDrmeexkVS1gLZy3xeVP+X8//9euaX756I2AOpaGMexOLYZzFYL6z9f94bd/nCNXqEl6+ezH133/zlvfApc0vyZNyM+wpq5P46H2z9ev/vAb/y0m1PE0oOFLF0GFe3P0TXiSCjS/9vNTUWtRDE2gpuoTD6hVKYLmeBdTqNmUMfmAWo0iaHJuvWnzP+HZGvEC8n+vzLmiu958B4ZnbZIPaNhE1gZMJtfaRhQJmOHQqY5QAM1UqN74StqWBu3T8AYpGiq2MqbfWB01W9vxTTtO9rKtbUSRQDmeaz3AFKhGHadfldyV18ZseXiDFAtVRTSjcyw4mXYUVH1Xuj9vhaBqtXV08wvcT81cTS9Ple9nMtNr3JitLOxZofZuMuy1ZS0lE4Ecz1dTS/apmbmQN7Za4ZejD0FtZc1J2JXoGBlRbnoyANT0b5ZnO9Eam18AamJN1ZxjiU2HSY48+E3y6I4rKPuZzS9zY6eaEvZSt5aUiQ2z5t6ZNbO0Hqhu85s9UGKSbM30jJoqoi2x8qFTAyW9f7CspUI17vPDeVtR80tlLDzLH/2yv6JxNdMza6q18mHOPlVAVfVL4NOswZXPlgnVij/jQIloXE11ouZCNdq2QJ8qOlRVU2cdKHGoWq68UGOmDKj2ATPW1PFRM0a/ZoDX4WQPnqnwItpJL+hL9KkqTdXS5l+n9tq5UzMBTwgTtfToF67CBhr/QAkYZoi3cbJGLxiNbefO8CLaZ0M1E+Sn4fWEMFVzjX596iCqBir5yjlT4Fi7VQzIaDBjkd00WjPtPKhW9k4Cqjuj5I3ZgVR1eaGGDs2Cmt5kSzlpj4FqJGrYW+WMUkZUs3RynGNZ5er4UUrNUy7UjZt2JlQ+rjNSDUF1nOJt5X1u3SkefQE4xStEKidqClTwksYq19GPr04brZoJOW1EPlQr0SBUyyne4c0DD9ad4rEXgFO8I0CFvYkpeWsqPHBWB6VCHVNTndH8iNGvS9W1pqDqTvGEOw3TKR57ATjFWxaqW5QeqFE3dvahMaitDTWzpiozdpbipcIO2oRSBWuqcoq3/+CadYuGVybV/FpO8WaASu8Igw46I24+xf820Yuo5zBf/Maw1kYyEfvfBPPmP7WINb1PVU7x+p+eGDDLf5r0jmc6xctxkDOVf+6gs9yQkKY8avLBNWMbiVpLOWugpupO8Yh2gFM8/sJ2irdk85sCNdDR5N6itVIe73DSNGMbiQ0fktp6EKpyikfqLK2pQPMLOMUrA9XZhQNFdWeDXIWGhLmLKXiqbsppp+yb6ADu0gRtJI21QaiaU7yteGE4xeNQHad41uTDyA1SzoYNGdUtGPPIdDd2zkPikm69QRvTU6Dqkw26E+c8a532GLNN6CuZ3NMkOcUzoY7eIKUfqffSzte91R4/QjQSapcOdUQvaLsw0OfhAWuhexcmVC/V9OFDilM8HcG0DVLGLhwfVGcOdaTDyVSo44Y21nZ3iQO25u0WZOPbG1YglRsTOkYmbZCCojqTa2JmXLw3HOH3fqhGzQk9hMJS/tBGzzhP0oDqWpsKlXw+I9TRUZ1dODpULV5rQXUeXy0PMO+nGhWn90AFBiPtWKgGVYFDWWtToWpjKxNqq8fSA0pDLbhBygNVfCi6ITdc1QkIqvHeMpsxoR+JqKdI01F/RFLGVW+IqmVRt2Ck5OZyinQjZTZIWQMlKIo4D19xtDBUwwB4SDBfzouQ+FdPJqRnwJ7K8FJ1LAKZnQVqkRmlTN+E8jw8hdGaU0CiTw1YzJrQD8ez8qm9VGNgcyojDaqm1qY6Y5+62GJuVQrgaIf3RPqZAuXm3noLUx0BVUvIhqoPg5Og6rcFnNzOB3WR5SxMshC8Q1gLKlCnLaiRFKdCNRaN2dZSKqoJ1Ze3FUEt727drqnhQ/PmV8dBNRIbYc14uNhyUAttkMropcNQgTk5z6FLQm2LQLVyWxpqiTVKbvObKo8vOqvTiRwq+uCIsjMH5lGklWtNba+GMptfckEF0IyH6j3IthF7P+HQ5O98IcORaJGCAEOgCpweTFWwT/UehFDDRvrSUAttkAoehFDDRvriUInKbJDyHoRQw0b6WaAGNKr5RR1Z5Ua/qLVoltEv6riaZfSLOrImjX7RNexqFUKDUE9UCLVCjYdq6eWWrCCmf19e83dQqPhNsUR+n6+tuJHgpCzSV/ZoIjWPdgZePUy3QspMPxXXimEpfHBQWVB3d2TcRf6+v77i76DQb/jvU4IlEu8HO6+R4KQs0gzsrdVZqXk0432l72sabYWU2f4uZMWwFD44qCyo7x7lz/DFYS+h0C/4r/9yyIz758asCbHgpCySI7//09ePgWB/Hs14j1Z5jrQylNlOOxXXimEpfHBQyVAP983l10WgmpZYvMFcoDTs4KQskiO/vXuXDxXIXzB7eVaUqWyofWI5jG1+n8gXp1jz+9WDldtIcFIWaSbsq7lxDeePn5ZoxEmZvdVOJav5tQ8OKnugtJf9NjRQ2sOdfsASNBCJBSdlkWXgnTtQSsmjGW9rfTfGWWFjHXUqrhVnoOQ/OKgiKy1Q6xJCrVAItUIh1AqFUCsUQq1QCLVCIdQKhVArFEKtUAi1QiHUCoVQKxRCrVAItUIh1AqFUCsUQq1QCLVCIdQKhVArFEKtUAi1QiHUCoVQK9T/AbPKD23X71RaAAAAAElFTkSuQmCC" alt="plot of chunk scoreg"/></p>

<pre><code class="r">plotScorem(result, ncomp = 5, cultivar, cex = 1)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk scoreg"/></p>

<h3><a name="pls"></a>Partial least-squares (PLS) regression</h3>

<p>PLS regression can be calculated using <code>plsr</code> function of <code>pls</code> package. <code>plsr</code> function returns an output variable of the class <code>mvr</code>. The latent variables can be visualized in a contour representation using <code>plotLoading</code> function. Similarly, the regression coefficient can be visualized in a contour representation using <code>plotReg</code> function.</p>

<pre><code class="r"># load gluten data
data(gluten)
gluten_uf &lt;- unfold(gluten) # unfold list into matrix

# delete columns with NA values
index &lt;- colSums(is.na(gluten_uf)) == 0
gluten_uf &lt;- gluten_uf[, index]
gluten_ratio &lt;- as.numeric(names(gluten))

require(pls)
model &lt;- plsr(gluten_ratio ~ gluten_uf, ncomp = 3)
plotLoading(model, ncomp = 3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk pls"/></p>

<pre><code class="r">plotReg(model) 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk pls"/></p>

<h2><a name="ref"></a>References</h2>

<p>Fujita, K., Tsuta, M., Kokawa, M., &amp; Sugiyama, J. (2010). Detection of deoxynivalenol using fluorescence excitation-emission matrix. Food and Bioprocess Technology, 3(6), 922-927.</p>

<p>Murphy, K. R., Stedmon, C. A., Graeber, D., &amp; Bro, R. (2013). Tutorial Review: Fluorescence spectroscopy and multi-way techniques. PARAFAC. Analytical Methods. </p>

</body>

</html>
